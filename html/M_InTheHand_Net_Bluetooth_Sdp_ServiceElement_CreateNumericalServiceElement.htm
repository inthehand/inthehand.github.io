<!DOCTYPE html ><html lang="en-US"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" href="../css/bulma.css" /><link rel="stylesheet" href="../css/font-awesome.min.css" /><link rel="stylesheet" href="../css/presentationStyle.css" /><link rel="stylesheet" href="../css/vs.min.css" /><script src="../scripts/jquery-3.5.1.min.js"></script><script src="../scripts/clipboard.min.js"></script><script src="../scripts/highlight.min.js"></script><script src="../scripts/presentationStyle.js"></script><title>ServiceElement.CreateNumericalServiceElement Method</title><meta name="Title" content="CreateNumericalServiceElement" /><meta name="Help.Id" content="M:InTheHand.Net.Bluetooth.Sdp.ServiceElement.CreateNumericalServiceElement(InTheHand.Net.Bluetooth.Sdp.ElementType,System.Object)" /><meta name="Help.ContentType" content="Reference" /><meta name="container" content="InTheHand.Net.Bluetooth.Sdp" /><meta name="guid" content="M_InTheHand_Net_Bluetooth_Sdp_ServiceElement_CreateNumericalServiceElement" /><meta name="Description" content="Create an instance of but internally converting the numeric value to the required type." /><meta name="tocFile" content="../toc/IDCFEA.xml" /></head><body><div class="fixedLayout"><div id="Header" class="fixedHeader"><div class="pageHeader level mb-0 py-2 px-4"><div id="TitleContainer" class="level-left"><div class="level-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/inthehand/32feet/"><img alt="32feet.NET" style="height: 48px; width: 48px;" src="../icons/circlelogo.png" /></a></div><div id="DocumentationTitle" class="level-item">32feet.NET - Personal Area Networking for .NET</div></div><div id="LangFilterSearchContainer" class="level-right"><div class="level-item"><div class="dropdown is-hoverable"><div class="dropdown-trigger"><button class="button" aria-haspopup="true" aria-controls="dropdown-menu"><span id="CurrentLanguage"></span><span class="icon is-small"><i class="fa fa-angle-down" aria-hidden="true"></i></span></button></div><div class="dropdown-menu" role="menu"><div id="LanguageSelections" class="dropdown-content"><a class="dropdown-item languageFilterItem" data-languageId="cs">C#</a><a class="dropdown-item languageFilterItem" data-languageId="vb">VB</a><a class="dropdown-item languageFilterItem" data-languageId="cpp">C++</a><a class="dropdown-item languageFilterItem" data-languageId="fs">F#</a></div></div></div></div><div class="level-item"><form id="SearchForm" action="#" onsubmit="TransferToSearchPage(); return false;"><div class="field"><div class="control has-icons-left"><input id="SearchTerms" class="input" type="text" maxlength="200" placeholder="Search" /><span class="icon is-small is-left"><i class="fa fa-search"></i></span><button id="SearchButton" type="submit" class="is-hidden"></button></div></div></form></div></div></div></div><div class="fixedContent"><div id="HeaderPrelimContainer" class="level my-1 px-2"><div id="HeaderTextContainer" class="level-left"><div class="level-item"><span class="has-text-grey-light"><h3><a href="https://github.com/inthehand/32feet">github.com / inthehand / 32feet</a></h3></span></div></div><div id="PreliminaryContainer" class="level-left"><div class="level-item"><span class="tag is-warning is-medium">This is preliminary documentation and is subject to change.</span></div></div></div><nav class="breadcrumb my-1 px-2 border-bottom" role="navigation"><ul id="TopicBreadcrumbs" /></nav><div class="columns pl-5 pr-5 fixedContent"><div id="ShowHideTOCColumn" class="column is-hidden-tablet"><a id="ShowHideTOC">Show/Hide TOC</a></div><div id="TOCColumn" class="column is-hidden-mobile"><nav class="toc"><ul id="TableOfContents" class="toc-menu" /></nav></div><div id="TopicContent" class="column content is-7"><h1>Service<wbr />Element<span id="LSTE5B35535_0" data-languageSpecificText="cpp=::|nu=."></span>Create<wbr />Numerical<wbr />Service<wbr />Element Method</h1><div class="summary">
            Create an instance of <span class="noLink">ServiceElement</span>
            but internally converting the numeric value to the required type.
            </div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Definition</h2><div id="IDBSection"><strong>Namespace:</strong> <a href="N_InTheHand_Net_Bluetooth_Sdp.htm">InTheHand.Net.Bluetooth.Sdp</a><br /><strong>Assembly:</strong> InTheHand.Net.Bluetooth (in InTheHand.Net.Bluetooth.dll) Version: 4.0.30+1af847c156a3fd10c1014acf1a38df1d0ca2ade4<div class="codeSnippet" data-codeSnippetLanguage="cs"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">ServiceElement</span> <span class="identifier">CreateNumericalServiceElement</span>(
	<span class="identifier">ElementType</span> <span class="parameter">elementType</span>,
	<span class="identifier">Object</span> <span class="parameter">value</span>
)</code></pre></div></div><div class="codeSnippet is-hidden" data-codeSnippetLanguage="vb"><div class="codeHeader"><span class="codeHeaderTitle">VB</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-vb"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">CreateNumericalServiceElement</span> ( 
	<span class="parameter">elementType</span> <span class="keyword">As</span> <span class="identifier">ElementType</span>,
	<span class="parameter">value</span> <span class="keyword">As</span> <span class="identifier">Object</span>
) <span class="keyword">As</span> <span class="identifier">ServiceElement</span></code></pre></div></div><div class="codeSnippet is-hidden" data-codeSnippetLanguage="cpp"><div class="codeHeader"><span class="codeHeaderTitle">C++</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cpp"><span class="keyword">public</span>:
<span class="keyword">static</span> <span class="identifier">ServiceElement</span>^ <span class="identifier">CreateNumericalServiceElement</span>(
	<span class="identifier">ElementType</span> <span class="parameter">elementType</span>, 
	<span class="identifier">Object</span>^ <span class="parameter">value</span>
)</code></pre></div></div><div class="codeSnippet is-hidden" data-codeSnippetLanguage="fs"><div class="codeHeader"><span class="codeHeaderTitle">F#</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-fs"><span class="keyword">static</span> <span class="keyword">member</span> <span class="identifier">CreateNumericalServiceElement</span> : 
        <span class="parameter">elementType</span> : <span class="identifier">ElementType</span> * 
        <span class="parameter">value</span> : <span class="identifier">Object</span> <span class="keyword">-&gt;</span> <span class="identifier">ServiceElement</span> </code></pre></div></div><h4 class="quickLinkHeader">Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">elementType</span>  <a href="T_InTheHand_Net_Bluetooth_Sdp_ElementType.htm">ElementType</a></dt><dd>The type of the element as an ElementType.
            Should be one of the <span class="code">UnsignedInteger</span>/<span class="code">TwosComplementInteger</span> types.
            </dd><dt class="has-text-weight-normal"><span class="parameter">value</span>  <a href="https://docs.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a></dt><dd>The value for the new element,
            should be a numerical type.
            </dd></dl><h4 class="quickLinkHeader">Return Value</h4><a href="T_InTheHand_Net_Bluetooth_Sdp_ServiceElement.htm">ServiceElement</a><br />The new element.
            </div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Remarks</h2><div id="IDBCSection"><p>As noted in the constructor documentation 
            (<span class="noLink">#ctor(ElementType, Object)</span>)
            the type of the value supplied <strong>must</strong> exactly match the element's natural type,
            the contructor will return an error if that is not the case. This method 
            will instead attempt to convert the value to the required type.  It uses 
            the <a href="https://docs.microsoft.com/dotnet/api/system.iconvertible" target="_blank" rel="noopener noreferrer">IConvertible</a> interface to do the conversion, for
            instance if the element type is <span class="code">Uint16</span> then it will cast the input value
            to <a href="https://docs.microsoft.com/dotnet/api/system.iconvertible" target="_blank" rel="noopener noreferrer">IConvertible</a> and call 
            <a href="https://docs.microsoft.com/dotnet/api/system.iconvertible.touint16#System_IConvertible_ToUInt16_System_IFormatProvider_" target="_blank" rel="noopener noreferrer">ToUInt16(IFormatProvider)</a> on it.
            If the value is not convertible to the element type then an 
            <a href="https://docs.microsoft.com/dotnet/api/system.argumentoutofrangeexception" target="_blank" rel="noopener noreferrer">ArgumentOutOfRangeException</a> will be thrown see below.
            </p><p>For instance, passing in an C# <span class="code">int</span> / Visual Basic <span class="code">Integer</span>
            to the constructor will fail for element types <span class="noLink">UInt8</span>
            etc, however by using this method it will succeed if the value is in the
            correct range.
            For example
            <div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-C#">int i = 10;
int j = -1;

// Error, Int32 not suitable for element type UInt8.
ServiceElement e0 = new ServiceElement(ElementType.UInt8, i);

// Success, Byte value 10 stored.
ServiceElement e1 = ServiceElement.CreateNumericalServiceElement(ElementType.UInt8, i);

// Error, -1 not in range of type Byte.
ServiceElement e2 = ServiceElement.CreateNumericalServiceElement(ElementType.UInt8, j);</code></pre></div></div>
            The last example failing with:
            <div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle"> </span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-plaintext">System.ArgumentOutOfRangeException: Value '-1'  of type 'System.Int32' not valid for element type UInt16.
 ---&gt; System.OverflowException: Value was either too large or too small for a UInt16.
   at System.Convert.ToUInt16(Int32 value)
   at System.Int32.System.IConvertible.ToUInt16(IFormatProvider provider)
   at InTheHand.Net.Bluetooth.ServiceElement.ConvertNumericalValue(ElementType elementType, Object value)
   --- End of inner exception stack trace ---
   at InTheHand.Net.Bluetooth.ServiceElement.ConvertNumericalValue(ElementType elementType, Object value)
   at InTheHand.Net.Bluetooth.ServiceElement.CreateNumericalServiceElement(ElementType elementType, Object value)
   at MiscFeatureTestCs.Main(String[] args)</code></pre></div></div></p></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Exceptions</h2><div id="IDFCSection"><table class="table is-hoverable"><tr><td><a href="https://docs.microsoft.com/dotnet/api/system.argumentexception" target="_blank" rel="noopener noreferrer">ArgumentException</a></td><td>
            The <span class="parameter">elementType</span> is not a numerical type.
            </td></tr><tr><td><a href="https://docs.microsoft.com/dotnet/api/system.argumentoutofrangeexception" target="_blank" rel="noopener noreferrer">ArgumentOutOfRangeException</a></td><td>
            The value wasn’t convertible to the required type, e.g. if -1 is
            passed for element type UInt8, as shown above.
            </td></tr></table></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>See Also</h2><div id="seeAlsoSection"><h4>Reference</h4><div><a href="T_InTheHand_Net_Bluetooth_Sdp_ServiceElement.htm">ServiceElement Class</a></div><div><a href="N_InTheHand_Net_Bluetooth_Sdp.htm">InTheHand.Net.Bluetooth.Sdp Namespace</a></div></div></div><div id="InThisArticleColumn" class="column is-hidden-mobile"><nav class="menu sticky is-hidden"><p class="menu-label"><strong>In This Article</strong></p><ul id="InThisArticleMenu" class="menu-list"><li><a class="quickLink">Definition</a><ul class="menu"><li><a class="quickLink">Parameters</a></li><li><a class="quickLink">Return Value</a></li></ul></li><li><a class="quickLink">Remarks</a></li><li><a class="quickLink">Exceptions</a></li><li><a class="quickLink">See Also</a></li></ul></nav></div></div></div><footer id="PageFooter" class="footer border-top py-3 fixedFooter"><div class="columns"><div class="column"><p>Have feedback on the documentation? Open an issue <a href="https://github.com/inthehand/32feet/issues">on GitHub</a>.</p><p><a href="https://inthehand.com" target="_blank" rel="noopener noreferrer">Copyright © 2003-2022 In The Hand Ltd. All Rights Reserved.</a></p> 
				</div><div class="column"> 
				</div></div></footer></div><script>$(function(){
SetDefaultLanguage("cs");
LoadTocFile(null, null);
InitializeQuickLinks();

$(".toggleSection" ).click(function () {
    SectionExpandCollapse(this);
});

$(".toggleSection").keypress(function () {
    SectionExpandCollapseCheckKey(this, event)
});
hljs.highlightAll();
});</script></body></html>
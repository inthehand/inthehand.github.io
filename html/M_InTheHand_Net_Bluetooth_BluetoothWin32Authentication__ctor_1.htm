<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>BluetoothWin32Authentication Constructor (EventHandler(BluetoothWin32AuthenticationEventArgs))</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:InTheHand.Net.Bluetooth.BluetoothWin32Authentication.#ctor(System.EventHandler{InTheHand.Net.Bluetooth.BluetoothWin32AuthenticationEventArgs})" /><meta name="Description" content="Initializes a new instance of the class, to call a specified handler when any device requires authentication." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="InTheHand.Net.Bluetooth" /><meta name="file" content="M_InTheHand_Net_Bluetooth_BluetoothWin32Authentication__ctor_1" /><meta name="guid" content="M_InTheHand_Net_Bluetooth_BluetoothWin32Authentication__ctor_1" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">In The Hand<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="R_Project_InTheHand.htm" title="In The Hand" tocid="roottoc">In The Hand</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="R_Project_InTheHand.htm" title="Namespaces" tocid="R_Project_InTheHand">Namespaces</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="N_InTheHand_Net_Bluetooth.htm" title="InTheHand.Net.Bluetooth" tocid="N_InTheHand_Net_Bluetooth">InTheHand.Net.Bluetooth</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="T_InTheHand_Net_Bluetooth_BluetoothWin32Authentication.htm" title="BluetoothWin32Authentication Class" tocid="T_InTheHand_Net_Bluetooth_BluetoothWin32Authentication">BluetoothWin32Authentication Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Overload_InTheHand_Net_Bluetooth_BluetoothWin32Authentication__ctor.htm" title="BluetoothWin32Authentication Constructor " tocid="Overload_InTheHand_Net_Bluetooth_BluetoothWin32Authentication__ctor">BluetoothWin32Authentication Constructor </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="M_InTheHand_Net_Bluetooth_BluetoothWin32Authentication__ctor_1.htm" title="BluetoothWin32Authentication Constructor (EventHandler(BluetoothWin32AuthenticationEventArgs))" tocid="M_InTheHand_Net_Bluetooth_BluetoothWin32Authentication__ctor_1">BluetoothWin32Authentication Constructor (EventHandler(BluetoothWin32AuthenticationEventArgs))</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_InTheHand_Net_Bluetooth_BluetoothWin32Authentication__ctor.htm" title="BluetoothWin32Authentication Constructor (BluetoothAddress, String)" tocid="M_InTheHand_Net_Bluetooth_BluetoothWin32Authentication__ctor">BluetoothWin32Authentication Constructor (BluetoothAddress, String)</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn">BluetoothWin32Authentication Constructor (EventHandler<span id="LST4BD04DE3_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4BD04DE3_0?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script>BluetoothWin32AuthenticationEventArgs<span id="LST4BD04DE3_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4BD04DE3_1?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script>)</td></tr></table><span class="introStyle">Combined library for <a href="http://github.com/inthehand/Pontoon">Pontoon</a>, <a href="http://github.com/inthehand/32feet">32feet</a> and <a href="http://github.com/inthehand/InTheHand.Forms">InTheHand.Forms</a></span> <div class="summary">
             Initializes a new instance of the <a href="T_InTheHand_Net_Bluetooth_BluetoothWin32Authentication.htm">BluetoothWin32Authentication</a> class,
             to call a specified handler when any device requires authentication.
             </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_InTheHand_Net_Bluetooth.htm">InTheHand.Net.Bluetooth</a><br />
    <strong>Assembly:</strong>
   InTheHand.Net.Personal (in InTheHand.Net.Personal.dll) Version: 3.7.1102.0<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0ECCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','cs','1','3');return false;">C#</a></div><div id="ID0ECCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','vb','2','3');return false;">VB</a></div><div id="ID0ECCA_tab3" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','fs','3','3');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0ECCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0ECCA');return false;" title="Copy">Copy</a></div></div><div id="ID0ECCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="identifier">BluetoothWin32Authentication</span>(
	<span class="identifier">EventHandler</span>&lt;<span class="identifier">BluetoothWin32AuthenticationEventArgs</span>&gt; <span class="parameter">handler</span>
)</pre></div><div id="ID0ECCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Sub</span> <span class="identifier">New</span> ( 
	<span class="parameter">handler</span> <span class="keyword">As</span> <span class="identifier">EventHandler</span>(<span class="keyword">Of</span> <span class="identifier">BluetoothWin32AuthenticationEventArgs</span>)
)</pre></div><div id="ID0ECCA_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">new</span> : 
        <span class="parameter">handler</span> : <span class="identifier">EventHandler</span>&lt;<span class="identifier">BluetoothWin32AuthenticationEventArgs</span>&gt; <span class="keyword">-&gt;</span> <span class="identifier">BluetoothWin32Authentication</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0ECCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">handler</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/db0etb8x" target="_blank">System<span id="LST4BD04DE3_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4BD04DE3_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>EventHandler</a><span id="LST4BD04DE3_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4BD04DE3_3?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script><a href="T_InTheHand_Net_Bluetooth_BluetoothWin32AuthenticationEventArgs.htm">BluetoothWin32AuthenticationEventArgs</a><span id="LST4BD04DE3_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4BD04DE3_4?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script><br />A reference to a handler function that can respond
             to authentication requests.
             </dd></dl></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID2RBSection" class="collapsibleSection"><p>See the example below.
             </p><p>The callback mode can be configured to do a callback after the 
             ‘send PIN’action, this allows one to see if it was successful 
             etc.  An example sequence where the PIN was <strong>incorrect</strong> is as follows.
             </p><div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAECBA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAECBA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAECBA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">Authenticate one device -- with wrong passcode here the first two times.
Passcode respectively: 'BAD-x', 'BAD-y', '9876'
Making PC discoverable
Hit Return to complete
Authenticating 0017E464CF1E wm_alan1
  Attempt# 0, Last error code 0
  Sending "BAD-x"
Authenticating 0017E464CF1E wm_alan1
  Attempt# 1, Last error code 1244
  Sending "BAD-y"
Authenticating 0017E464CF1E wm_alan1
  Attempt# 2, Last error code 1167
  Sending "9876"
Authenticating 0017E464CF1E wm_alan1
  Attempt# 3, Last error code 1167
etc</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAECBA");</script><p>
             That is we see the error code of <span class="code">1244=NativeErrorNotAuthenticated</span>
             once, and then the peer device disappears (<span class="code">1167=NativeErrorDeviceNotConnected</span>).
             I suppose that's a security feature -- its stops an attacker
             from trying again and again with different passcodes.
            
             Anyway the result of that is that is it <strong>not</strong> worth repeating 
             the callback after the device disappears.  The code now enforces this.  With 
             <a href="P_InTheHand_Net_Bluetooth_BluetoothWin32AuthenticationEventArgs_CallbackWithResult.htm">CallbackWithResult</a> 
             set to <span class="code">true</span>, if the result of the previous attempt was ‘success’ 
             or ‘device not connected’ then any new PIN set in the callback 
             won’t be used and thus the callback won’t be called again 
             for that authentication attempt.
             </p><p>A successful authentication process can thus be detected by setting
             <span class="code">CallbackWithResult=true</span> and checking in the callback if
             <div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAACCBA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAACCBA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAACCBA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">e.PreviousNativeErrorCode == NativeErrorSuccess &amp;&amp; e.AttemptNumber != <span class="highlight-number">0</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAACCBA");</script></p><p /><p>The instance will continue receiving authentication requests
             until it is disposed or garbage collected, so keep a reference to it
             whilst it should be active, and call 
             <a href="M_InTheHand_Net_Bluetooth_BluetoothWin32Authentication_Dispose.htm">Dispose<span id="LST4BD04DE3_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4BD04DE3_5?cs=()|vb=|cpp=()|nu=()|fs=()");</script></a>
             when you’re finished.
             </p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Examples</span></div><div id="ID3RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EAAABA_tab1" class="codeSnippetContainerTabSingle">VB</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAAABA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAAABA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAAABA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">Using</span> pairer <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> BluetoothWin32Authentication(<span class="highlight-keyword">AddressOf</span> Win32AuthCallbackHandler)
    Console.WriteLine(<span class="highlight-literal">"Hit Return to stop authenticating"</span>)
    Console.ReadLine()
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Using</span>
...

<span class="highlight-keyword">Sub</span> Win32AuthCallbackHandler(<span class="highlight-keyword">ByVal</span> sender <span class="highlight-keyword">As</span> <span class="highlight-keyword">Object</span>, <span class="highlight-keyword">ByVal</span> e <span class="highlight-keyword">As</span> InTheHand.Net.Bluetooth.BluetoothWin32AuthenticationEventArgs)
   <span class="highlight-keyword">Dim</span> address <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span> = e.Device.DeviceAddress.ToString()
   Console.WriteLine(<span class="highlight-literal">"Received an authentication request from address "</span> + address)

   <span class="highlight-comment">' compare the first 8 hex numbers, this is just a special case because in the</span>
   <span class="highlight-comment">' used scenario the model of the devices can be identified by the first 8 hex</span>
   <span class="highlight-comment">' numbers, the last 4 numbers being the device specific part.</span>
   <span class="highlight-keyword">If</span> address.Substring(<span class="highlight-number">0</span>, <span class="highlight-number">8</span>).Equals(<span class="highlight-literal">"0099880D"</span>) <span class="highlight-keyword">OrElse</span> _
           address.Substring(<span class="highlight-number">0</span>, <span class="highlight-number">8</span>).Equals(<span class="highlight-literal">"0099880E"</span>) <span class="highlight-keyword">Then</span>
       <span class="highlight-comment">' send authentication response</span>
       e.Pin = <span class="highlight-literal">"5276"</span>
   <span class="highlight-keyword">ElseIf</span> (address.Substring(<span class="highlight-number">0</span>, <span class="highlight-number">8</span>).Equals(<span class="highlight-literal">"00997788"</span>)) <span class="highlight-keyword">Then</span>
       <span class="highlight-comment">' send authentication response</span>
       e.Pin = <span class="highlight-literal">"ásdfghjkl"</span>
   <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAAABA");</script></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID4RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_InTheHand_Net_Bluetooth_BluetoothWin32Authentication.htm">BluetoothWin32Authentication Class</a></div><div class="seeAlsoStyle"><a href="Overload_InTheHand_Net_Bluetooth_BluetoothWin32Authentication__ctor.htm">BluetoothWin32Authentication Overload</a></div><div class="seeAlsoStyle"><a href="N_InTheHand_Net_Bluetooth.htm">InTheHand.Net.Bluetooth Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"><p><a href="http://inthehand.com" target="_blank">Copyright (c) 2002-2017 In The Hand Ltd</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:support%40inthehand.com?Subject=In The Hand">In The Hand Support</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script> </div></body></html>
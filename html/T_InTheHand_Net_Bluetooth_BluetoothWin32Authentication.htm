<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>BluetoothWin32Authentication Class</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="BluetoothWin32Authentication class" /><meta name="System.Keywords" content="InTheHand.Net.Bluetooth.BluetoothWin32Authentication class" /><meta name="System.Keywords" content="BluetoothWin32Authentication class, about BluetoothWin32Authentication class" /><meta name="Microsoft.Help.F1" content="InTheHand.Net.Bluetooth.BluetoothWin32Authentication" /><meta name="Microsoft.Help.Id" content="T:InTheHand.Net.Bluetooth.BluetoothWin32Authentication" /><meta name="Description" content="Provides Bluetooth authentication services on desktop Windows." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="InTheHand.Net.Bluetooth" /><meta name="file" content="T_InTheHand_Net_Bluetooth_BluetoothWin32Authentication" /><meta name="guid" content="T_InTheHand_Net_Bluetooth_BluetoothWin32Authentication" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">In The Hand<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="R_Project_InTheHand.htm" title="In The Hand" tocid="roottoc">In The Hand</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="R_Project_InTheHand.htm" title="Namespaces" tocid="R_Project_InTheHand">Namespaces</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="N_InTheHand_Net_Bluetooth.htm" title="InTheHand.Net.Bluetooth" tocid="N_InTheHand_Net_Bluetooth">InTheHand.Net.Bluetooth</a></div><div class="toclevel1 current" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="T_InTheHand_Net_Bluetooth_BluetoothWin32Authentication.htm" title="BluetoothWin32Authentication Class" tocid="T_InTheHand_Net_Bluetooth_BluetoothWin32Authentication">BluetoothWin32Authentication Class</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Overload_InTheHand_Net_Bluetooth_BluetoothWin32Authentication__ctor.htm" title="BluetoothWin32Authentication Constructor " tocid="Overload_InTheHand_Net_Bluetooth_BluetoothWin32Authentication__ctor">BluetoothWin32Authentication Constructor </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Methods_T_InTheHand_Net_Bluetooth_BluetoothWin32Authentication.htm" title="BluetoothWin32Authentication Methods" tocid="Methods_T_InTheHand_Net_Bluetooth_BluetoothWin32Authentication">BluetoothWin32Authentication Methods</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Fields_T_InTheHand_Net_Bluetooth_BluetoothWin32Authentication.htm" title="BluetoothWin32Authentication Fields" tocid="Fields_T_InTheHand_Net_Bluetooth_BluetoothWin32Authentication">BluetoothWin32Authentication Fields</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn">BluetoothWin32Authentication Class</td></tr></table><span class="introStyle">Combined library for <a href="http://github.com/inthehand/Pontoon">Pontoon</a>, <a href="http://github.com/inthehand/32feet">32feet</a> and <a href="http://github.com/inthehand/InTheHand.Forms">InTheHand.Forms</a></span> <div class="summary">
             Provides Bluetooth authentication services on desktop Windows.
             </div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Inheritance Hierarchy</span></div><div id="ID0RBSection" class="collapsibleSection"><a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">System<span id="LST13D014DF_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST13D014DF_0?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Object</a><br />  <span class="selflink">InTheHand.Net.Bluetooth<span id="LST13D014DF_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST13D014DF_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>BluetoothWin32Authentication</span><br /></div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_InTheHand_Net_Bluetooth.htm">InTheHand.Net.Bluetooth</a><br />
    <strong>Assembly:</strong>
   InTheHand.Net.Personal (in InTheHand.Net.Personal.dll) Version: 3.7.1102.0<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1ECCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID1ECCA','cs','1','3');return false;">C#</a></div><div id="ID1ECCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID1ECCA','vb','2','3');return false;">VB</a></div><div id="ID1ECCA_tab3" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID1ECCA','fs','3','3');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1ECCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1ECCA');return false;" title="Copy">Copy</a></div></div><div id="ID1ECCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">class</span> <span class="identifier">BluetoothWin32Authentication</span> : <span class="identifier">IDisposable</span></pre></div><div id="ID1ECCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Class</span> <span class="identifier">BluetoothWin32Authentication</span>
	<span class="keyword">Implements</span> <span class="identifier">IDisposable</span></pre></div><div id="ID1ECCA_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">type</span> <span class="identifier">BluetoothWin32Authentication</span> =  
    <span class="keyword">class</span>
        <span class="keyword">interface</span> <span class="identifier">IDisposable</span>
    <span class="keyword">end</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1ECCA");</script></div><p>The <span class="selflink">BluetoothWin32Authentication</span> type exposes the following members.</p><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Constructors</span></div><div id="ID3RBSection" class="collapsibleSection"><table class="members" id="constructorList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="M_InTheHand_Net_Bluetooth_BluetoothWin32Authentication__ctor_1.htm">BluetoothWin32Authentication(EventHandler<span id="LST13D014DF_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST13D014DF_2?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script>BluetoothWin32AuthenticationEventArgs<span id="LST13D014DF_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST13D014DF_3?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script>)</a></td><td><div class="summary">
             Initializes a new instance of the <span class="selflink">BluetoothWin32Authentication</span> class,
             to call a specified handler when any device requires authentication.
             </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_InTheHand_Net_Bluetooth_BluetoothWin32Authentication__ctor.htm">BluetoothWin32Authentication(BluetoothAddress, String)</a></td><td><div class="summary">
            Initializes a new instance of the <span class="selflink">BluetoothWin32Authentication</span> class,
            to respond to a specific address with a specific PIN string.
            </div></td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Methods</span></div><div id="ID4RBSection" class="collapsibleSection"><table class="members" id="methodList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_InTheHand_Net_Bluetooth_BluetoothWin32Authentication_Dispose.htm">Dispose<span id="LST13D014DF_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST13D014DF_4?cs=()|vb=|cpp=()|nu=()|fs=()");</script></a></td><td><div class="summary">
            Release the unmanaged resources used by the <span class="selflink">BluetoothWin32Authentication</span>.
            </div></td></tr><tr data="protected;declared;notNetfw;"><td><img src="../icons/protmethod.gif" alt="Protected method" title="Protected method" /></td><td><a href="M_InTheHand_Net_Bluetooth_BluetoothWin32Authentication_Dispose_1.htm">Dispose(Boolean)</a></td><td><div class="summary">
            Release the unmanaged resources used by the <span class="selflink">BluetoothWin32Authentication</span>,
            and optionally disposes of the managed resources.
            </div></td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/bsc2ak47" target="_blank">Equals</a></td><td> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="protected;inherited;notNetfw;"><td><img src="../icons/protmethod.gif" alt="Protected method" title="Protected method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/4k87zsw7" target="_blank">Finalize</a></td><td> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/zdee4b3y" target="_blank">GetHashCode</a></td><td> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/dfwy45w9" target="_blank">GetType</a></td><td> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="protected;inherited;notNetfw;"><td><img src="../icons/protmethod.gif" alt="Protected method" title="Protected method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/57ctke0a" target="_blank">MemberwiseClone</a></td><td> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="protected;declared;notNetfw;"><td><img src="../icons/protmethod.gif" alt="Protected method" title="Protected method" /></td><td><a href="M_InTheHand_Net_Bluetooth_BluetoothWin32Authentication_OnAuthentication.htm">OnAuthentication</a></td><td><div class="summary">
            Calls the authentication callback handler.
            </div></td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/7bxwbwt2" target="_blank">ToString</a></td><td> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID5RB')" onkeypress="SectionExpandCollapse_CheckKey('ID5RB', event)" tabindex="0"><img id="ID5RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Fields</span></div><div id="ID5RBSection" class="collapsibleSection"><table class="members" id="fieldList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubfield.gif" alt="Public field" title="Public field" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="F_InTheHand_Net_Bluetooth_BluetoothWin32Authentication_NativeErrorDeviceNotConnected.htm">NativeErrorDeviceNotConnected</a></td><td><div class="summary">
            Windows’ ERROR_DEVICE_NOT_CONNECTED
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubfield.gif" alt="Public field" title="Public field" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="F_InTheHand_Net_Bluetooth_BluetoothWin32Authentication_NativeErrorNotAuthenticated.htm">NativeErrorNotAuthenticated</a></td><td><div class="summary">
            Windows’ ERROR_NOT_AUTHENTICATED
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubfield.gif" alt="Public field" title="Public field" /><img src="../icons/static.gif" alt="Static member" title="Static member" /></td><td><a href="F_InTheHand_Net_Bluetooth_BluetoothWin32Authentication_NativeErrorSuccess.htm">NativeErrorSuccess</a></td><td><div class="summary">
            Windows’ ERROR_SUCCESS
            </div></td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID6RB')" onkeypress="SectionExpandCollapse_CheckKey('ID6RB', event)" tabindex="0"><img id="ID6RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID6RBSection" class="collapsibleSection"><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td>This class is supported on desktop Windows and with the Microsoft
             stack only.
             </td></tr></table></div><p>This class can be used in one of two ways.  Firstly
             an instance can be created specifying one device that is being connected
             to and the PIN string to use for it.  (That form is used internally by
             <a href="T_InTheHand_Net_Sockets_BluetoothClient.htm">BluetoothClient</a> to support
             its <a href="M_InTheHand_Net_Sockets_BluetoothClient_SetPin_1.htm">SetPin(String)</a> method).
             </p><p>Secondly it can also be used a mode where a user supplied
             callback will be called when any device requires authentication,
             the callback includes a parameter of type 
             <a href="T_InTheHand_Net_Bluetooth_BluetoothWin32AuthenticationEventArgs.htm">BluetoothWin32AuthenticationEventArgs</a>.
             Various authentication methods are available in Bluetooth version
             2.1 and later.  Which one is being used is indicated by the
             <a href="P_InTheHand_Net_Bluetooth_BluetoothWin32AuthenticationEventArgs_AuthenticationMethod.htm">AuthenticationMethod</a>
             property.
             If it is <a href="F_InTheHand_Net_Bluetooth_BluetoothAuthenticationMethod_Legacy.htm">Legacy</a>
             then the callback method should set the
             <a href="P_InTheHand_Net_Bluetooth_BluetoothWin32AuthenticationEventArgs_Pin.htm">Pin</a>
             property.
             </p><p>
             For the other authentication methods 
             e.g. <a href="F_InTheHand_Net_Bluetooth_BluetoothAuthenticationMethod_NumericComparison.htm">NumericComparison</a>
             or <a href="F_InTheHand_Net_Bluetooth_BluetoothAuthenticationMethod_OutOfBand.htm">OutOfBand</a>
             the callback method should use one or more of the other properties and
             methods e.g.
             <a href="P_InTheHand_Net_Bluetooth_BluetoothWin32AuthenticationEventArgs_NumberOrPasskey.htm">NumberOrPasskey</a>,
             <a href="P_InTheHand_Net_Bluetooth_BluetoothWin32AuthenticationEventArgs_Confirm.htm">Confirm</a>,
             <a href="P_InTheHand_Net_Bluetooth_BluetoothWin32AuthenticationEventArgs_ResponseNumberOrPasskey.htm">ResponseNumberOrPasskey</a>,
             <a href="M_InTheHand_Net_Bluetooth_BluetoothWin32AuthenticationEventArgs_ConfirmOob.htm">ConfirmOob(<span id="LST13D014DF_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST13D014DF_5?cpp=array&lt;");</script>Byte<span id="LST13D014DF_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST13D014DF_6?cpp=&gt;|cs=[]|vb=()|nu=[]|fs=[]");</script>, <span id="LST13D014DF_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST13D014DF_7?cpp=array&lt;");</script>Byte<span id="LST13D014DF_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST13D014DF_8?cpp=&gt;|cs=[]|vb=()|nu=[]|fs=[]");</script>)</a>
             etc.
             </p><p>
             See the example below for a 'Legacy' method handler.
             The callback mode can be configured to do a callback after the 
             ‘send PIN’ action, this allows one to see if it was successful 
             etc.  An example sequence where the PIN was <strong>incorrect</strong> is as follows.
             </p><div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EAEBBA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EAEBBA');return false;" title="Copy">Copy</a></div></div><div id="ID1EAEBBA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">Authenticate one device -- with wrong passcode here the first two times.
Passcode respectively: 'BAD-x', 'BAD-y', '9876'
Making PC discoverable
Hit Return to complete
Authenticating 0017E464CF1E wm_alan1
  Attempt# 0, Last error code 0
  Sending "BAD-x"
Authenticating 0017E464CF1E wm_alan1
  Attempt# 1, Last error code 1244
  Sending "BAD-y"
Authenticating 0017E464CF1E wm_alan1
  Attempt# 2, Last error code 1167
  Sending "9876"
Authenticating 0017E464CF1E wm_alan1
  Attempt# 3, Last error code 1167
etc</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EAEBBA");</script><p>
             That is we see the error code of <span class="code">1244=NativeErrorNotAuthenticated</span>
             once, and then the peer device disappears (<span class="code">1167=NativeErrorDeviceNotConnected</span>).
             I suppose that's a security feature -- its stops an attacker
             from trying again and again with different passcodes.
            
             Anyway the result of that is that is it <strong>not</strong> worth repeating 
             the callback after the device disappears.  The code now enforces this.  With 
             <a href="P_InTheHand_Net_Bluetooth_BluetoothWin32AuthenticationEventArgs_CallbackWithResult.htm">CallbackWithResult</a> 
             set to <span class="code">true</span>, if the result of the previous attempt was ‘success’ 
             or ‘device not connected’ then any new PIN set in the callback 
             won’t be used and thus the callback won’t be called again 
             for that authentication attempt.
             </p><p>A successful authentication process can thus be detected by checking if
             <div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EAACBBA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EAACBBA');return false;" title="Copy">Copy</a></div></div><div id="ID1EAACBBA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">e.PreviousNativeErrorCode == NativeErrorSuccess &amp;&amp; e.AttemptNumber != <span class="highlight-number">0</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EAACBBA");</script></p><p /><p>The instance will continue receiving authentication requests
             until it is disposed or garbage collected, so keep a reference to it
             whilst it should be active and call 
             <a href="M_InTheHand_Net_Bluetooth_BluetoothWin32Authentication_Dispose.htm">Dispose<span id="LST13D014DF_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST13D014DF_9?cs=()|vb=|cpp=()|nu=()|fs=()");</script></a>
             when you’re finished.
             </p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID7RB')" onkeypress="SectionExpandCollapse_CheckKey('ID7RB', event)" tabindex="0"><img id="ID7RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Examples</span></div><div id="ID7RBSection" class="collapsibleSection">
             If one wants to respond to PIN requests for one device with a known PIN then
             use the simple form which is initialized with an address and PIN.
             <div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1EACABA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EACABA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EACABA');return false;" title="Copy">Copy</a></div></div><div id="ID1EACABA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">BluetoothWin32Authentication authenticator
    = <span class="highlight-keyword">new</span> BluetoothWin32Authentication(remoteEP.Address, m_pin);
<span class="highlight-comment">// when the peer is expected to require pairing, perhaps do some work.</span>
authenticator.Dispose();</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EACABA");</script>
             
             If one wants to see the PIN request, perhaps to be able to check the type
             of the peer by its address then use the form here which requests callbacks.
             (Note that this code assumes that 'Legacy' PIN-based pairing is being
             used; setting the Pin property will presumably have no effect if the
             authentication method being used is one of the v2.1 SSP forms).
             <div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1EAAABA_tab1" class="codeSnippetContainerTabSingle">VB</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EAAABA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EAAABA');return false;" title="Copy">Copy</a></div></div><div id="ID1EAAABA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">Using</span> pairer <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> BluetoothWin32Authentication(<span class="highlight-keyword">AddressOf</span> Win32AuthCallbackHandler)
    Console.WriteLine(<span class="highlight-literal">"Hit Return to stop authenticating"</span>)
    Console.ReadLine()
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Using</span>
...

<span class="highlight-keyword">Sub</span> Win32AuthCallbackHandler(<span class="highlight-keyword">ByVal</span> sender <span class="highlight-keyword">As</span> <span class="highlight-keyword">Object</span>, <span class="highlight-keyword">ByVal</span> e <span class="highlight-keyword">As</span> InTheHand.Net.Bluetooth.BluetoothWin32AuthenticationEventArgs)
   <span class="highlight-comment">' Note we assume here that 'Legacy' pairing is being used,</span>
   <span class="highlight-comment">' and thus we only set the Pin property!</span>
   <span class="highlight-keyword">Dim</span> address <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span> = e.Device.DeviceAddress.ToString()
   Console.WriteLine(<span class="highlight-literal">"Received an authentication request from address "</span> + address)

   <span class="highlight-comment">' compare the first 8 hex numbers, this is just a special case because in the</span>
   <span class="highlight-comment">' used scenario the model of the devices can be identified by the first 8 hex</span>
   <span class="highlight-comment">' numbers, the last 4 numbers being the device specific part.</span>
   <span class="highlight-keyword">If</span> address.Substring(<span class="highlight-number">0</span>, <span class="highlight-number">8</span>).Equals(<span class="highlight-literal">"0099880D"</span>) <span class="highlight-keyword">OrElse</span> _
           address.Substring(<span class="highlight-number">0</span>, <span class="highlight-number">8</span>).Equals(<span class="highlight-literal">"0099880E"</span>) <span class="highlight-keyword">Then</span>
       <span class="highlight-comment">' send authentication response</span>
       e.Pin = <span class="highlight-literal">"5276"</span>
   <span class="highlight-keyword">ElseIf</span> (address.Substring(<span class="highlight-number">0</span>, <span class="highlight-number">8</span>).Equals(<span class="highlight-literal">"00997788"</span>)) <span class="highlight-keyword">Then</span>
       <span class="highlight-comment">' send authentication response</span>
       e.Pin = <span class="highlight-literal">"ásdfghjkl"</span>
   <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EAAABA");</script></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID8RB')" onkeypress="SectionExpandCollapse_CheckKey('ID8RB', event)" tabindex="0"><img id="ID8RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID8RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="N_InTheHand_Net_Bluetooth.htm">InTheHand.Net.Bluetooth Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"><p><a href="http://inthehand.com" target="_blank">Copyright (c) 2002-2017 In The Hand Ltd</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:support%40inthehand.com?Subject=In The Hand">In The Hand Support</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script> </div></body></html>
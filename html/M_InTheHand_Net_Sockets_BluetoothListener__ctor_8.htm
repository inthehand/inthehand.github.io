<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>BluetoothListener Constructor (Guid, Byte[], Int32)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:InTheHand.Net.Sockets.BluetoothListener.#ctor(System.Guid,System.Byte[],System.Int32)" /><meta name="Description" content="Initializes a new instance of the class to listen on the specified service identifier, publishing the specified SDP record." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="InTheHand.Net.Sockets" /><meta name="file" content="M_InTheHand_Net_Sockets_BluetoothListener__ctor_8" /><meta name="guid" content="M_InTheHand_Net_Sockets_BluetoothListener__ctor_8" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">In The Hand<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="R_Project_InTheHand.htm" title="In The Hand" tocid="roottoc">In The Hand</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="R_Project_InTheHand.htm" title="Namespaces" tocid="R_Project_InTheHand">Namespaces</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="N_InTheHand_Net_Sockets.htm" title="InTheHand.Net.Sockets" tocid="N_InTheHand_Net_Sockets">InTheHand.Net.Sockets</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="T_InTheHand_Net_Sockets_BluetoothListener.htm" title="BluetoothListener Class" tocid="T_InTheHand_Net_Sockets_BluetoothListener">BluetoothListener Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Overload_InTheHand_Net_Sockets_BluetoothListener__ctor.htm" title="BluetoothListener Constructor " tocid="Overload_InTheHand_Net_Sockets_BluetoothListener__ctor">BluetoothListener Constructor </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_InTheHand_Net_Sockets_BluetoothListener__ctor_6.htm" title="BluetoothListener Constructor (Guid)" tocid="M_InTheHand_Net_Sockets_BluetoothListener__ctor_6">BluetoothListener Constructor (Guid)</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_InTheHand_Net_Sockets_BluetoothListener__ctor_3.htm" title="BluetoothListener Constructor (BluetoothEndPoint)" tocid="M_InTheHand_Net_Sockets_BluetoothListener__ctor_3">BluetoothListener Constructor (BluetoothEndPoint)</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_InTheHand_Net_Sockets_BluetoothListener__ctor_7.htm" title="BluetoothListener Constructor (Guid, ServiceRecord)" tocid="M_InTheHand_Net_Sockets_BluetoothListener__ctor_7">BluetoothListener Constructor (Guid, ServiceRecord)</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_InTheHand_Net_Sockets_BluetoothListener__ctor.htm" title="BluetoothListener Constructor (BluetoothAddress, Guid)" tocid="M_InTheHand_Net_Sockets_BluetoothListener__ctor">BluetoothListener Constructor (BluetoothAddress, Guid)</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_InTheHand_Net_Sockets_BluetoothListener__ctor_4.htm" title="BluetoothListener Constructor (BluetoothEndPoint, ServiceRecord)" tocid="M_InTheHand_Net_Sockets_BluetoothListener__ctor_4">BluetoothListener Constructor (BluetoothEndPoint, ServiceRecord)</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="M_InTheHand_Net_Sockets_BluetoothListener__ctor_8.htm" title="BluetoothListener Constructor (Guid, Byte[], Int32)" tocid="M_InTheHand_Net_Sockets_BluetoothListener__ctor_8">BluetoothListener Constructor (Guid, Byte[], Int32)</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_InTheHand_Net_Sockets_BluetoothListener__ctor_1.htm" title="BluetoothListener Constructor (BluetoothAddress, Guid, ServiceRecord)" tocid="M_InTheHand_Net_Sockets_BluetoothListener__ctor_1">BluetoothListener Constructor (BluetoothAddress, Guid, ServiceRecord)</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_InTheHand_Net_Sockets_BluetoothListener__ctor_5.htm" title="BluetoothListener Constructor (BluetoothEndPoint, Byte[], Int32)" tocid="M_InTheHand_Net_Sockets_BluetoothListener__ctor_5">BluetoothListener Constructor (BluetoothEndPoint, Byte[], Int32)</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_InTheHand_Net_Sockets_BluetoothListener__ctor_2.htm" title="BluetoothListener Constructor (BluetoothAddress, Guid, Byte[], Int32)" tocid="M_InTheHand_Net_Sockets_BluetoothListener__ctor_2">BluetoothListener Constructor (BluetoothAddress, Guid, Byte[], Int32)</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn">BluetoothListener Constructor (Guid, <span id="LSTCA35D731_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTCA35D731_0?cpp=array&lt;");</script>Byte<span id="LSTCA35D731_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTCA35D731_1?cpp=&gt;|vb=()|nu=[]");</script>, Int32)</td></tr></table><span class="introStyle">Combined library for <a href="http://github.com/inthehand/Pontoon">Pontoon</a>, <a href="http://github.com/inthehand/32feet">32feet</a> and <a href="http://github.com/inthehand/InTheHand.Forms">InTheHand.Forms</a></span> <div class="summary">
            Initializes a new instance of the <a href="T_InTheHand_Net_Sockets_BluetoothListener.htm">BluetoothListener</a> class
            to listen on the specified service identifier, 
            publishing the specified SDP record.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_InTheHand_Net_Sockets.htm">InTheHand.Net.Sockets</a><br />
    <strong>Assembly:</strong>
   InTheHand.Net.Personal (in InTheHand.Net.Personal.dll) Version: 3.7.1102.0<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0ECCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','cs','1','3');return false;">C#</a></div><div id="ID0ECCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','vb','2','3');return false;">VB</a></div><div id="ID0ECCA_tab3" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','fs','3','3');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0ECCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0ECCA');return false;" title="Copy">Copy</a></div></div><div id="ID0ECCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="identifier">BluetoothListener</span>(
	<span class="identifier">Guid</span> <span class="parameter">service</span>,
	<span class="identifier">byte</span>[] <span class="parameter">sdpRecord</span>,
	<span class="identifier">int</span> <span class="parameter">channelOffset</span>
)</pre></div><div id="ID0ECCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Sub</span> <span class="identifier">New</span> ( 
	<span class="parameter">service</span> <span class="keyword">As</span> <span class="identifier">Guid</span>,
	<span class="parameter">sdpRecord</span> <span class="keyword">As</span> <span class="identifier">Byte</span>(),
	<span class="parameter">channelOffset</span> <span class="keyword">As</span> <span class="identifier">Integer</span>
)</pre></div><div id="ID0ECCA_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">new</span> : 
        <span class="parameter">service</span> : <span class="identifier">Guid</span> * 
        <span class="parameter">sdpRecord</span> : <span class="identifier">byte</span>[] * 
        <span class="parameter">channelOffset</span> : <span class="identifier">int</span> <span class="keyword">-&gt;</span> <span class="identifier">BluetoothListener</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0ECCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">service</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/cey1zx63" target="_blank">System<span id="LSTCA35D731_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTCA35D731_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Guid</a><br />The Bluetooth service to listen for.</dd><dt><span class="parameter">sdpRecord</span></dt><dd>Type: <span id="LSTCA35D731_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTCA35D731_3?cpp=array&lt;");</script><a href="http://msdn2.microsoft.com/en-us/library/yyb1w04y" target="_blank">System<span id="LSTCA35D731_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTCA35D731_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Byte</a><span id="LSTCA35D731_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTCA35D731_5?cpp=&gt;|vb=()|nu=[]");</script><br />Prepared SDP Record to publish.</dd><dt><span class="parameter">channelOffset</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LSTCA35D731_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTCA35D731_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />
            The index in the <span class="parameter">sdpRecord</span> byte array where the RFCOMM Channel Number that the
            server is listening on is to be placed.
            However the supplied record is now parsed into an <a href="T_InTheHand_Net_Bluetooth_ServiceRecord.htm">ServiceRecord</a>
            instance, and the channel offset is not used.
            </dd></dl></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td>
            The constructors taking the SDP record explicitly (as a byte array) should
            only be used if
            a specialized SDP record is required. For instance when using one of the
            standard profiles.  Otherwise use one of the other constructors 
            e.g. <a href="M_InTheHand_Net_Sockets_BluetoothListener__ctor_6.htm">BluetoothListener(Guid)</a>
            which create a generic SDP Record from the specified service identifier.
            </td></tr></table></div><p>Instead of passing a byte array containing a hand-built record,
            the record can also be built using the <a href="T_InTheHand_Net_Bluetooth_ServiceRecord.htm">ServiceRecord</a>
            and <a href="T_InTheHand_Net_Bluetooth_ServiceElement.htm">ServiceElement</a> classes, and
            passed to the respective constuctor, e.g.
            <a href="M_InTheHand_Net_Sockets_BluetoothListener__ctor_7.htm">BluetoothListener(Guid, ServiceRecord)</a></p><p>Any useful SDP record will include 
            a <span class="code">ProtocolDescriptor</span> element containing
            the RFCOMM Channel number that the server is listening on,
            and a <span class="code">ServiceClassId</span> element containing the service UUIDs.
            The record supplied in the <span class="parameter">sdpRecord</span> parameter
            should contain those elements.  On successful <a href="M_InTheHand_Net_Sockets_BluetoothListener_Start.htm">Start<span id="LSTCA35D731_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTCA35D731_7?cs=()|vb=|cpp=()|nu=()|fs=()");</script></a>,
            the RFCOMM Channel number that the protocol stack has assigned to the
            server is retrieved, and copied into the service record before it is
            published.  The <span class="parameter">channelOffset</span> indicates the location
            of the respective byte in the <span class="parameter">sdpRecord</span> byte array.
            </p><p>
            An example SDP record is as follows.  This is actually the format of the 
            generic record used in the other constructors.  For another example see
            the code in the <span class="code">ObexListener</span> class.
            <div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EADAABA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EADAABA');return false;" title="Copy">Copy</a></div></div><div id="ID0EADAABA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-comment">// The asterisks note where the Service UUID and the Channel number are</span>
<span class="highlight-comment">// to be filled in.</span>
<span class="highlight-keyword">byte</span>[] record = <span class="highlight-keyword">new</span> <span class="highlight-keyword">byte</span>[] {
  <span class="highlight-comment">//Element Sequence:</span>
  <span class="highlight-number">0x35</span>,<span class="highlight-number">0x27</span>,
    <span class="highlight-comment">//UInt16: 0x0001  -- ServiceClassIdList</span>
    <span class="highlight-number">0x09</span>,<span class="highlight-number">0x00</span>,<span class="highlight-number">0x01</span>,
    <span class="highlight-comment">//Element Sequence:</span>
    <span class="highlight-number">0x35</span>,<span class="highlight-number">0x11</span>,
    <span class="highlight-comment">//  UUID128: 00000000-0000-0000-0000-000000000000 -- * Service UUID</span>
        <span class="highlight-number">0x1c</span>,
          <span class="highlight-number">0x00</span>,<span class="highlight-number">0x00</span>,<span class="highlight-number">0x00</span>,<span class="highlight-number">0x00</span>, <span class="highlight-number">0x00</span>,<span class="highlight-number">0x00</span>,<span class="highlight-number">0x00</span>,<span class="highlight-number">0x00</span>,
          <span class="highlight-number">0x00</span>,<span class="highlight-number">0x00</span>,<span class="highlight-number">0x00</span>,<span class="highlight-number">0x00</span>, <span class="highlight-number">0x00</span>,<span class="highlight-number">0x00</span>,<span class="highlight-number">0x00</span>,<span class="highlight-number">0x00</span>,
    <span class="highlight-comment">// </span>
    <span class="highlight-comment">//UInt16: 0x0004  -- ProtocolDescriptorList</span>
    <span class="highlight-number">0x09</span>,<span class="highlight-number">0x00</span>,<span class="highlight-number">0x04</span>,
    <span class="highlight-comment">//Element Sequence:</span>
    <span class="highlight-number">0x35</span>,<span class="highlight-number">0x0c</span>,
    <span class="highlight-comment">//  Element Sequence:</span>
        <span class="highlight-number">0x35</span>,<span class="highlight-number">0x03</span>,
    <span class="highlight-comment">//      UUID16: 0x0100  -- L2CAP</span>
            <span class="highlight-number">0x19</span>,<span class="highlight-number">0x01</span>,<span class="highlight-number">0x00</span>,
    <span class="highlight-comment">//  Element Sequence:</span>
        <span class="highlight-number">0x35</span>,<span class="highlight-number">0x05</span>,
    <span class="highlight-comment">//      UUID16: 0x0003  -- RFCOMM</span>
            <span class="highlight-number">0x19</span>,<span class="highlight-number">0x00</span>,<span class="highlight-number">0x03</span>,
    <span class="highlight-comment">//      UInt8: 0x00     -- * Channel Number</span>
            <span class="highlight-number">0x08</span>,<span class="highlight-number">0x00</span>
};</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EADAABA");</script>
            For that record the <span class="code">channelOffset</span> is 40.
            </p></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID3RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_InTheHand_Net_Sockets_BluetoothListener.htm">BluetoothListener Class</a></div><div class="seeAlsoStyle"><a href="Overload_InTheHand_Net_Sockets_BluetoothListener__ctor.htm">BluetoothListener Overload</a></div><div class="seeAlsoStyle"><a href="N_InTheHand_Net_Sockets.htm">InTheHand.Net.Sockets Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"><p><a href="http://inthehand.com" target="_blank">Copyright (c) 2002-2017 In The Hand Ltd</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:support%40inthehand.com?Subject=In The Hand">In The Hand Support</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script> </div></body></html>
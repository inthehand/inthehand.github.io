<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>ServiceElement.CreateNumericalServiceElement Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="CreateNumericalServiceElement method" /><meta name="System.Keywords" content="ServiceElement.CreateNumericalServiceElement method" /><meta name="Microsoft.Help.F1" content="InTheHand.Net.Bluetooth.ServiceElement.CreateNumericalServiceElement" /><meta name="Microsoft.Help.Id" content="M:InTheHand.Net.Bluetooth.ServiceElement.CreateNumericalServiceElement(InTheHand.Net.Bluetooth.ElementType,System.Object)" /><meta name="Description" content="Create an instance of but internally converting the numeric value to the required type." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="InTheHand.Net.Bluetooth" /><meta name="file" content="M_InTheHand_Net_Bluetooth_ServiceElement_CreateNumericalServiceElement" /><meta name="guid" content="M_InTheHand_Net_Bluetooth_ServiceElement_CreateNumericalServiceElement" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">In The Hand<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="R_Project_InTheHand.htm" title="In The Hand" tocid="roottoc">In The Hand</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="R_Project_InTheHand.htm" title="Namespaces" tocid="R_Project_InTheHand">Namespaces</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="N_InTheHand_Net_Bluetooth.htm" title="InTheHand.Net.Bluetooth" tocid="N_InTheHand_Net_Bluetooth">InTheHand.Net.Bluetooth</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="T_InTheHand_Net_Bluetooth_ServiceElement.htm" title="ServiceElement Class" tocid="T_InTheHand_Net_Bluetooth_ServiceElement">ServiceElement Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Methods_T_InTheHand_Net_Bluetooth_ServiceElement.htm" title="ServiceElement Methods" tocid="Methods_T_InTheHand_Net_Bluetooth_ServiceElement">ServiceElement Methods</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="M_InTheHand_Net_Bluetooth_ServiceElement_CreateNumericalServiceElement.htm" title="CreateNumericalServiceElement Method " tocid="M_InTheHand_Net_Bluetooth_ServiceElement_CreateNumericalServiceElement">CreateNumericalServiceElement Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_InTheHand_Net_Bluetooth_ServiceElement_GetValueAsElementArray.htm" title="GetValueAsElementArray Method " tocid="M_InTheHand_Net_Bluetooth_ServiceElement_GetValueAsElementArray">GetValueAsElementArray Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_InTheHand_Net_Bluetooth_ServiceElement_GetValueAsElementList.htm" title="GetValueAsElementList Method " tocid="M_InTheHand_Net_Bluetooth_ServiceElement_GetValueAsElementList">GetValueAsElementList Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Overload_InTheHand_Net_Bluetooth_ServiceElement_GetValueAsString.htm" title="GetValueAsString Method " tocid="Overload_InTheHand_Net_Bluetooth_ServiceElement_GetValueAsString">GetValueAsString Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_InTheHand_Net_Bluetooth_ServiceElement_GetValueAsStringUtf8.htm" title="GetValueAsStringUtf8 Method " tocid="M_InTheHand_Net_Bluetooth_ServiceElement_GetValueAsStringUtf8">GetValueAsStringUtf8 Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_InTheHand_Net_Bluetooth_ServiceElement_GetValueAsUri.htm" title="GetValueAsUri Method " tocid="M_InTheHand_Net_Bluetooth_ServiceElement_GetValueAsUri">GetValueAsUri Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_InTheHand_Net_Bluetooth_ServiceElement_GetValueAsUuid.htm" title="GetValueAsUuid Method " tocid="M_InTheHand_Net_Bluetooth_ServiceElement_GetValueAsUuid">GetValueAsUuid Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn">ServiceElement<span id="LSTD348FD5E_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD348FD5E_0?cpp=::|nu=.");</script>CreateNumericalServiceElement Method </td></tr></table><span class="introStyle">Combined library for <a href="http://github.com/inthehand/Pontoon">Pontoon</a>, <a href="http://github.com/inthehand/32feet">32feet</a> and <a href="http://github.com/inthehand/InTheHand.Forms">InTheHand.Forms</a></span> <div class="summary">
            Create an instance of <a href="T_InTheHand_Net_Bluetooth_ServiceElement.htm">ServiceElement</a>
            but internally converting the numeric value to the required type.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_InTheHand_Net_Bluetooth.htm">InTheHand.Net.Bluetooth</a><br />
    <strong>Assembly:</strong>
   InTheHand.Net.Personal (in InTheHand.Net.Personal.dll) Version: 3.7.1102.0<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0ECCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','cs','1','3');return false;">C#</a></div><div id="ID0ECCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','vb','2','3');return false;">VB</a></div><div id="ID0ECCA_tab3" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','fs','3','3');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0ECCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0ECCA');return false;" title="Copy">Copy</a></div></div><div id="ID0ECCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">ServiceElement</span> <span class="identifier">CreateNumericalServiceElement</span>(
	<span class="identifier">ElementType</span> <span class="parameter">elementType</span>,
	<span class="identifier">Object</span> <span class="parameter">value</span>
)</pre></div><div id="ID0ECCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">CreateNumericalServiceElement</span> ( 
	<span class="parameter">elementType</span> <span class="keyword">As</span> <span class="identifier">ElementType</span>,
	<span class="parameter">value</span> <span class="keyword">As</span> <span class="identifier">Object</span>
) <span class="keyword">As</span> <span class="identifier">ServiceElement</span></pre></div><div id="ID0ECCA_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">static</span> <span class="keyword">member</span> <span class="identifier">CreateNumericalServiceElement</span> : 
        <span class="parameter">elementType</span> : <span class="identifier">ElementType</span> * 
        <span class="parameter">value</span> : <span class="identifier">Object</span> <span class="keyword">-&gt;</span> <span class="identifier">ServiceElement</span> 
</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0ECCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">elementType</span></dt><dd>Type: <a href="T_InTheHand_Net_Bluetooth_ElementType.htm">InTheHand.Net.Bluetooth<span id="LSTD348FD5E_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD348FD5E_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>ElementType</a><br />The type of the element as an ElementType.
            Should be one of the <span class="code">UnsignedInteger</span>/<span class="code">TwosComplementInteger</span> types.
            </dd><dt><span class="parameter">value</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">System<span id="LSTD348FD5E_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD348FD5E_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Object</a><br />The value for the new element,
            should be a numerical type.
            </dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="T_InTheHand_Net_Bluetooth_ServiceElement.htm">ServiceElement</a><br />The new element.
            </div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="tableSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/3w1b3114" target="_blank">ArgumentException</a></td><td>
            The <span class="parameter">elementType</span> is not a numerical type.
            </td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/8xt94y6e" target="_blank">ArgumentOutOfRangeException</a></td><td>
            The value wasn’t convertible to the required type, e.g. if -1 is
            passed for element type UInt8, as shown above.
            </td></tr></table></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID3RBSection" class="collapsibleSection"><p>As noted in the constructor documentation 
            (<a href="M_InTheHand_Net_Bluetooth_ServiceElement__ctor_2.htm">ServiceElement(ElementType, Object)</a>)
            the type of the value supplied <strong>must</strong> exactly match the element's natural type,
            the contructor will return an error if that is not the case. This method 
            will instead attempt to convert the value to the required type.  It uses 
            the <a href="http://msdn2.microsoft.com/en-us/library/tyz9cd4z" target="_blank">IConvertible</a> interface to do the conversion, for
            instance if the element type is <span class="code">Uint16</span> then it will cast the input value
            to <a href="http://msdn2.microsoft.com/en-us/library/tyz9cd4z" target="_blank">IConvertible</a> and call 
            <a href="http://msdn2.microsoft.com/en-us/library/3b4fwstw" target="_blank">ToUInt16(IFormatProvider)</a> on it.
            If the value is not convertible to the element type then an 
            <a href="http://msdn2.microsoft.com/en-us/library/8xt94y6e" target="_blank">ArgumentOutOfRangeException</a> will be thrown see below.
            </p><p>For instance, passing in an C# <span class="code">int</span> / Visual Basic <span class="code">Integer</span>
            to the constructor will fail for element types <a href="F_InTheHand_Net_Bluetooth_ElementType_UInt8.htm">UInt8</a>
            etc, however by using this method it will succeed if the value is in the
            correct range.
            For example
            <div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EACAFBA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EACAFBA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EACAFBA');return false;" title="Copy">Copy</a></div></div><div id="ID0EACAFBA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">int</span> i = <span class="highlight-number">10</span>;
<span class="highlight-keyword">int</span> j = <span class="highlight-number">-1</span>;

<span class="highlight-comment">// Error, Int32 not suitable for element type UInt8.</span>
ServiceElement e0 = <span class="highlight-keyword">new</span> ServiceElement(ElementType.UInt8, i);

<span class="highlight-comment">// Success, Byte value 10 stored.</span>
ServiceElement e1 = ServiceElement.CreateNumericalServiceElement(ElementType.UInt8, i);

<span class="highlight-comment">// Error, -1 not in range of type Byte.</span>
ServiceElement e2 = ServiceElement.CreateNumericalServiceElement(ElementType.UInt8, j);</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EACAFBA");</script>
            The last example failing with:
            <div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAAAFBA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAAAFBA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAAAFBA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">System.ArgumentOutOfRangeException: Value '-1'  of type 'System.Int32' not valid for element type UInt16.
 ---&gt; System.OverflowException: Value was either too large or too small for a UInt16.
   at System.Convert.ToUInt16(Int32 value)
   at System.Int32.System.IConvertible.ToUInt16(IFormatProvider provider)
   at InTheHand.Net.Bluetooth.ServiceElement.ConvertNumericalValue(ElementType elementType, Object value)
   --- End of inner exception stack trace ---
   at InTheHand.Net.Bluetooth.ServiceElement.ConvertNumericalValue(ElementType elementType, Object value)
   at InTheHand.Net.Bluetooth.ServiceElement.CreateNumericalServiceElement(ElementType elementType, Object value)
   at MiscFeatureTestCs.Main(String[] args)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAAAFBA");</script></p></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID4RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_InTheHand_Net_Bluetooth_ServiceElement.htm">ServiceElement Class</a></div><div class="seeAlsoStyle"><a href="N_InTheHand_Net_Bluetooth.htm">InTheHand.Net.Bluetooth Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"><p><a href="http://inthehand.com" target="_blank">Copyright (c) 2002-2017 In The Hand Ltd</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:support%40inthehand.com?Subject=In The Hand">In The Hand Support</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script> </div></body></html>